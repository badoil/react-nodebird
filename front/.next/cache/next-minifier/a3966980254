{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{RNiq:function(e,t,n){\"use strict\";n.r(t);var c=n(\"o0o1\"),i=n.n(c),a=n(\"q1tI\"),l=n.n(a),o=n(\"/MKj\"),r=n(\"5rEg\"),u=n(\"2/Rp\"),s=n(\"p+NB\"),d=l.a.createElement,p=function(){var e=Object(o.c)((function(e){return e.post})),t=e.imagePaths,n=e.isAddingPost,c=e.postAdded,i=Object(o.b)(),l=Object(a.useState)(\"\"),p=l[0],f=l[1],m=Object(a.useRef)();Object(a.useEffect)((function(){c&&f(\"\")}),[c]);var b=Object(a.useCallback)((function(e){if(e.preventDefault(),!p||!p.trim())return alert(\"no text\");var n=new FormData;t.forEach((function(e){n.append(\"image\",e)})),n.append(\"content\",p),i({type:s.e,data:n})}),[p]),g=Object(a.useCallback)((function(e){f(e.target.value)}),[]),h=Object(a.useCallback)((function(e){console.log(\"targetFile:\",e.target.files);var t=new FormData;[].forEach.call(e.target.files,(function(e){t.append(\"image\",e)})),i({type:s.J,data:t})}),[]),v=Object(a.useCallback)((function(){m.current.click()}),[m.current]),w=Object(a.useCallback)((function(e){return function(){i({type:s.y,index:e})}}),[]);return d(\"form\",{style:{margin:\"10px 0 20px\"},encType:\"multipart/form-data\",onSubmit:b},d(r.a.TextArea,{maxLength:140,placeholder:\"write something\",value:p,onChange:g}),d(\"div\",null,d(\"input\",{type:\"file\",multiple:!0,hidden:!0,ref:m,onChange:h}),d(u.a,{onClick:v},\"image upload\"),d(u.a,{type:\"primary\",htmlType:\"submit\",style:{float:\"right\"},loading:n},\"submit\")),d(\"div\",null,t.map((function(e,t){return d(\"div\",{key:e,style:{display:\"inline-block\"}},d(\"img\",{src:\"http://localhost:3306/\".concat(e),style:{width:\"200px\"},alt:e}),d(\"div\",null,d(u.a,{onClick:w(t)},\"remove\")))}))))},f=n(\"3wDy\"),m=l.a.createElement,b=function(){var e=Object(o.b)(),t=Object(a.useRef)([]),n=Object(o.c)((function(e){return e.user})),c=n.me,i=n.isLoggedIn,l=Object(o.c)((function(e){return e.post})),r=l.mainPosts,u=l.hasMorePosts,d=Object(a.useCallback)((function(){if(window.scrollY+document.documentElement.clientHeight>document.documentElement.scrollHeight-300&&u){var n=r[r.length-1].id;t.current.includes(n)||(e({type:s.q,lastId:n}),t.current.push(n))}}),[r&&r.length,u]);return Object(a.useEffect)((function(){return window.addEventListener(\"scroll\",d),function(){window.removeEventListener(\"scroll\",d)}}),[r.length]),m(\"div\",null,c?m(\"div\",null,\"login: \",c.nickname):m(\"div\",null,\"logout\"),i&&m(p,null),r.map((function(e){return m(f.a,{key:e.id,post:e})})))};b.getInitialProps=function(e){return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:e.store.dispatch({type:s.q});case 1:case\"end\":return t.stop()}}),null,null,null,Promise)};t.default=b},vlRD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/\",function(){return n(\"RNiq\")}])}},[[\"vlRD\",1,2,0,4,3,5,6,7]]]);"}